<div class="page">
    <div class="hd">
        <h1 class="page_title">确认支付</h1>
    </div>
    <div class="bd spacing">
        <div class="weui_text_area">
          将为您<strong>{{ params.body }}{{ params.detail }}</strong>，请确认后支付。
        </div>
        <button type="button" class="weui_btn weui_btn_primary" id="chooseWXPay">支付</button>
    </div>
</div>

{{#extend "scripts"}}
    <script src="/jweixin-1.0.0.js"></script>
    <script>
     $('#chooseWXPay').click(function () {
         WeixinJSBridge.invoke(
             'getBrandWCPayRequest', {{{json payargs }}},
             function(res){
                 _log(res);
             }
         );
     });

     function _log(msg) {
         $.ajax({
             url: '/log',
             type: 'post',
             data: {
                 msg: msg
             }
         });
         WeixinJSBridge.call('closeWindow');
     }
    </script>
{{/extend}}
